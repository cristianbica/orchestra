# Plan: Document repo operating rules (document workflow)

Date: 2026-02-11

## Goal
- Document the repo operating rules (what may/may not be edited; what is canonical) for contributors to THIS repo.
- Update the repo’s framework docs so future contributors (and agents) follow the same policy even when older docs disagree.

## Non-goals
- No changes to agent definitions, workflows, templates, or humans guide content.
- No behavior changes to `install.sh` or distribution logic.
- No repo-wide refactor of docs outside the specific targets below.

## Source of truth
- The policy in the user request for this task is the source of truth, even if it conflicts with existing documentation.

## Files to edit
- `.ai/docs/overview.md`
- `.ai/docs/patterns/architecture.md`
- `.ai/MEMORY.md`

## Steps
1. Add a short “Repo operating rules (contributors)” section to `.ai/docs/overview.md` that states:
   - Allowed to edit: `.ai/docs/`, `.ai/plans/`, `.ai/MEMORY.md`.
   - Forbidden to edit: `.ai/agents/`, `.ai/workflows/`, `.ai/templates/`, `.ai/HUMANS.md`.
   - `src/` is the canonical source in this repo and may be changed.
   - Anything in `src/` will be distributed to users; keep `src/` changes generic and template-safe.
   - If any other doc conflicts with these rules, this policy wins.

2. Update `.ai/docs/patterns/architecture.md` minimally to align with the above policy:
   - Keep the “two-tier layout” explanation, but explicitly state that for THIS repo’s contributor workflow:
     - `src/` is canonical.
     - `.ai/` is a working copy/mirror used to run workflows, but edits are restricted to the allowed paths.

3. Update `.ai/MEMORY.md` with a single durable convention bullet capturing the same operating rules.
   - Keep it short and stable (avoid rationale; put rationale in the docs).

## Conflicts to resolve (minimal adjustments)
- `.ai/docs/overview.md` currently describes `src/ai/` as canonical and implies user repos “never edit `src/ai/` directly”. Adjust language so it does not instruct contributors to treat `.ai/` as universally editable or `src/` as off-limits.
- `.ai/docs/patterns/architecture.md` currently states `src/ai/`/`src/tools/` are canonical sources and `.ai/` is installed output; add the new edit/forbidden rules and the “`src/` distributed—keep generic” constraint.
- `AGENTS.md` currently states “`.ai/` is canonical source of truth”. Do NOT edit this file (out of scope per policy); instead, add an explicit “policy overrides other docs” note in `.ai/docs/overview.md`.

## Verification
- Manual read-through:
  - `.ai/docs/overview.md` includes the operating rules section and is contributor-oriented.
  - `.ai/docs/patterns/architecture.md` is consistent with the operating rules.
  - `.ai/MEMORY.md` includes exactly one concise bullet for the new convention.
- Optional grep checks (to ensure no contradictory guidance remains in the updated docs):
  - `rg "never edit (src/ai|src/)" .ai/docs/overview.md .ai/docs/patterns/architecture.md`
  - `rg "\.ai/ is the canonical" .ai/docs/overview.md .ai/docs/patterns/architecture.md`

## Doc impact
- updated: `.ai/docs/overview.md`, `.ai/docs/patterns/architecture.md`

## Memory impact
- updated: add one bullet to `.ai/MEMORY.md` capturing the operating rules
